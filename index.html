<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Java TreeMap Visualization</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Lucide React icons as inline SVG components
        const Play = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
        );

        const Trash2 = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
        );

        const Plus = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );

        const Info = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12.01" y2="8"></line>
            </svg>
        );

        const TreeMapVisualization = () => {
            const [nodes, setNodes] = useState([
                { key: 50, value: 'Root', x: 400, y: 80, color: 'black' }
            ]);
            const [inputKey, setInputKey] = useState('');
            const [inputValue, setInputValue] = useState('');
            const [message, setMessage] = useState('');

            const calculatePositions = (nodeList) => {
                if (nodeList.length === 0) return [];
                
                const sorted = [...nodeList].sort((a, b) => a.key - b.key);
                const positioned = [];
                
                const buildTree = (arr, depth = 0, xMin = 0, xMax = 800, parent = null) => {
                    if (arr.length === 0) return;
                    
                    const midIdx = Math.floor(arr.length / 2);
                    const node = arr[midIdx];
                    const x = (xMin + xMax) / 2;
                    const y = 80 + depth * 100;
                    
                    positioned.push({
                        ...node,
                        x,
                        y,
                        parent
                    });
                    
                    buildTree(arr.slice(0, midIdx), depth + 1, xMin, x, { x, y });
                    buildTree(arr.slice(midIdx + 1), depth + 1, x, xMax, { x, y });
                };
                
                buildTree(sorted);
                return positioned;
            };

            const addNode = () => {
                const key = parseInt(inputKey);
                if (isNaN(key) || inputValue.trim() === '') {
                    setMessage('Please enter valid key (number) and value');
                    return;
                }
                
                if (nodes.some(n => n.key === key)) {
                    setMessage(`Key ${key} already exists. Updating value...`);
                    setNodes(nodes.map(n => n.key === key ? { ...n, value: inputValue } : n));
                } else {
                    setMessage(`Added: ${key} -> ${inputValue}`);
                    const newNodes = [...nodes, { key, value: inputValue, color: 'red' }];
                    setNodes(calculatePositions(newNodes));
                }
                
                setInputKey('');
                setInputValue('');
            };

            const removeNode = (key) => {
                setMessage(`Removed key: ${key}`);
                const newNodes = nodes.filter(n => n.key !== key);
                setNodes(calculatePositions(newNodes));
            };

            const clear = () => {
                setNodes([]);
                setMessage('TreeMap cleared');
            };

            const demo = () => {
                const demoData = [
                    { key: 50, value: 'Fifty' },
                    { key: 30, value: 'Thirty' },
                    { key: 70, value: 'Seventy' },
                    { key: 20, value: 'Twenty' },
                    { key: 40, value: 'Forty' },
                    { key: 60, value: 'Sixty' },
                    { key: 80, value: 'Eighty' }
                ];
                setNodes(calculatePositions(demoData));
                setMessage('Demo data loaded');
            };

            const positionedNodes = calculatePositions(nodes);

            return (
                <div className="w-full h-screen bg-gradient-to-br from-slate-900 to-slate-800 p-6 overflow-hidden">
                    <div className="max-w-7xl mx-auto h-full flex flex-col">
                        <div className="mb-4">
                            <h1 className="text-3xl font-bold text-white mb-2">Java TreeMap Visualization</h1>
                            <p className="text-slate-300 text-sm">A Red-Black tree implementation with O(log n) operations</p>
                        </div>

                        <div className="bg-slate-800/50 backdrop-blur rounded-lg p-4 mb-4 border border-slate-700">
                            <div className="flex flex-wrap gap-3 items-end">
                                <div className="flex-1 min-w-[120px]">
                                    <label className="block text-slate-300 text-sm mb-1">Key (Integer)</label>
                                    <input
                                        type="number"
                                        value={inputKey}
                                        onChange={(e) => setInputKey(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && addNode()}
                                        placeholder="e.g., 42"
                                        className="w-full px-3 py-2 bg-slate-700 text-white rounded border border-slate-600 focus:outline-none focus:border-blue-500"
                                    />
                                </div>
                                <div className="flex-1 min-w-[120px]">
                                    <label className="block text-slate-300 text-sm mb-1">Value (String)</label>
                                    <input
                                        type="text"
                                        value={inputValue}
                                        onChange={(e) => setInputValue(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && addNode()}
                                        placeholder="e.g., Hello"
                                        className="w-full px-3 py-2 bg-slate-700 text-white rounded border border-slate-600 focus:outline-none focus:border-blue-500"
                                    />
                                </div>
                                <button
                                    onClick={addNode}
                                    className="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded flex items-center gap-2 transition-colors"
                                >
                                    <Plus size={18} />
                                    Add/Update
                                </button>
                                <button
                                    onClick={demo}
                                    className="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded flex items-center gap-2 transition-colors"
                                >
                                    <Play size={18} />
                                    Load Demo
                                </button>
                                <button
                                    onClick={clear}
                                    className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded flex items-center gap-2 transition-colors"
                                >
                                    <Trash2 size={18} />
                                    Clear
                                </button>
                            </div>
                            {message && (
                                <div className="mt-3 px-3 py-2 bg-slate-700 text-slate-200 rounded text-sm">
                                    {message}
                                </div>
                            )}
                        </div>

                        <div className="flex-1 bg-slate-800/30 backdrop-blur rounded-lg border border-slate-700 overflow-auto">
                            <svg width="800" height="500" className="w-full h-full">
                                {positionedNodes.map((node, i) => {
                                    if (node.parent) {
                                        return (
                                            <line
                                                key={`line-${i}`}
                                                x1={node.parent.x}
                                                y1={node.parent.y}
                                                x2={node.x}
                                                y2={node.y}
                                                stroke="#64748b"
                                                strokeWidth="2"
                                            />
                                        );
                                    }
                                    return null;
                                })}

                                {positionedNodes.map((node, i) => (
                                    <g key={`node-${i}`}>
                                        <circle
                                            cx={node.x}
                                            cy={node.y}
                                            r="30"
                                            fill={node.color === 'red' ? '#ef4444' : '#1e293b'}
                                            stroke={node.color === 'red' ? '#dc2626' : '#475569'}
                                            strokeWidth="3"
                                            className="cursor-pointer hover:opacity-80 transition-opacity"
                                            onClick={() => removeNode(node.key)}
                                        />
                                        <text
                                            x={node.x}
                                            y={node.y - 5}
                                            textAnchor="middle"
                                            fill="white"
                                            fontSize="14"
                                            fontWeight="bold"
                                            className="pointer-events-none"
                                        >
                                            {node.key}
                                        </text>
                                        <text
                                            x={node.x}
                                            y={node.y + 10}
                                            textAnchor="middle"
                                            fill="#94a3b8"
                                            fontSize="10"
                                            className="pointer-events-none"
                                        >
                                            {node.value}
                                        </text>
                                    </g>
                                ))}
                            </svg>
                        </div>

                        <div className="mt-4 bg-slate-800/50 backdrop-blur rounded-lg p-4 border border-slate-700">
                            <div className="flex items-start gap-2">
                                <Info size={20} className="text-blue-400 mt-0.5 flex-shrink-0" />
                                <div className="text-slate-300 text-sm space-y-1">
                                    <p><strong className="text-white">TreeMap Properties:</strong> Sorted by keys, O(log n) get/put/remove operations</p>
                                    <p><strong className="text-white">Colors:</strong> Black nodes are balanced, Red nodes indicate recent insertions</p>
                                    <p><strong className="text-white">Tip:</strong> Click any node to remove it from the tree</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<TreeMapVisualization />, document.getElementById('root'));
    </script>
</body>
</html>